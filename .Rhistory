getwd()
#knitr::opts_chunk$set(echo = TRUE)
setwd("~/uni_folder/ASM/asm_time_series/")
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
abline(v=1992:2020,lty=3,col=4)
getwd()
serie
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
abline(v=1992:2020,lty=3,col=4)
(m <- apply (matrix(serie[1:(27*12)], nr=12),2, mean)) # to check for constant variance
(v <- apply (matrix(serie[1:(27*12)], nr=12),2, var))
plot(v~m)
group <- c(rep(1:27, rep(12, 27)))
boxplot(serie ~ group,
xlab = "Year",
ylab = "Monthly values",
main = "Check of constant variance (yearly boxplots)")
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
abline(v=1992:2020,lty=3,col=4)
(m <- apply (matrix(serie[1:(27*12)], nr=12),2, mean)) # to check for constant variance
(v <- apply (matrix(serie[1:(27*12)], nr=12),2, var))
plot(v~m)
abline(lm(v~m),col=2,lty=3)
group <- c(rep(1:27, rep(12, 27)))
boxplot(serie ~ group,
xlab = "Year",
ylab = "Monthly values",
main = "Check of constant variance (yearly boxplots)")
monthplot(serie)
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
abline(v=1992:2020,lty=3,col=4)
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Trafico en España", ylab="Miles de Individuos")
gc()
Sys.setlocale("LC_ALL", "es_ES.UTF-8")
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
abline(v=1992:2020,lty=3,col=4)
(m <- apply (matrix(serie[1:(27*12)], nr=12),2, mean)) # to check for constant variance
(v <- apply (matrix(serie[1:(27*12)], nr=12),2, var))
plot(v~m)
abline(lm(v~m),col=2,lty=3)
group <- c(rep(1:27, rep(12, 27)))
boxplot(serie ~ group,
xlab = "Year",
ylab = "Monthly values",
main = "Check of constant variance (yearly boxplots)")
monthplot(serie)
d12serie=diff(serie,12)
plot(d12serie)
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
abline(v=1992:2020,lty=3,col=4)
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
abline(v=1992:2020,lty=3,col=4)
(m <- apply (matrix(serie[1:(27*12)], nr=12),2, mean)) # to check for constant variance
(v <- apply (matrix(serie[1:(27*12)], nr=12),2, var))
plot(v~m)
abline(lm(v~m),col=2,lty=3)
group <- c(rep(1:27, rep(12, 27)))
boxplot(serie ~ group,
xlab = "Year",
ylab = "Monthly values",
main = "Check of constant variance (yearly boxplots)")
monthplot(serie)
d12serie=diff(serie,12)
plot(d12serie)
abline(h=0)
d12serie=diff(serie,12)
plot(d12serie)
abline(h=0, col='red')
?abline
d12serie=diff(serie,12)
plot(d12serie)
abline(h=0, col='red', lty=2)
abline(h=0, col='red', lty=3)
abline(h=0, col='red', lty=4)
d12serie=diff(serie,12)
plot(d12serie)
abline(h=0, col='red', lty=2)
d12serie=diff(serie,12)
plot(d12serie)
abline(h=0, col='red', lty=2)
plot(d12serie)
d1d12serie=diff(d12serie,1)
#fix this output
var(serie)
var(d12serie)
var(d1d12serie) # our transformation
var(diff(d1d12serie)) # 2 regular differences
plot(d1d12serie)
abline(h=0)
plot(d12serie)
abline(h=0, col='red', lty=2)
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
abline(v=1992:2020,lty=3,col=4)
(m <- apply (matrix(serie[1:(27*12)], nr=12),2, mean)) # to check for constant variance
(v <- apply (matrix(serie[1:(27*12)], nr=12),2, var))
plot(v~m)
abline(lm(v~m),col=2,lty=3)
group <- c(rep(1:27, rep(12, 27)))
boxplot(serie ~ group,
xlab = "Year",
ylab = "Monthly values",
main = "Check of constant variance (yearly boxplots)")
monthplot(serie)
d12serie=diff(serie,12)
plot(d12serie)
abline(h=0, col='red', lty=2)
d1d12serie=diff(d12serie,1)
#fix this output
var(serie)
var(d12serie)
var(d1d12serie) # our transformation
var(diff(d1d12serie)) # 2 regular differences
plot(d1d12serie)
abline(h=0, col='red', lty=2)
tserie <- d1d12serie #transformed serie is new name
par(mfrow=c(1,2))
acf(tserie, ylim=c(-1,1), lag.max=60, lwd=2)
pacf(tserie, ylim=c(-1,1), lag.max=60, lwd=2)
par(mfrow=c(1,2))
acf(tserie, ylim=c(-1,1), lag.max=60, lwd=2)
pacf(tserie, ylim=c(-1,1), lag.max=60, lwd=2)
gc()
serie=ts(read.table("victimas.dat")/1000,start=1993,freq=12)
plot(serie, main="Victimas de Accidentes de Tráfico en España", ylab="Miles de Individuos")
abline(v=1992:2020,lty=3,col=4)
(m <- apply (matrix(serie[1:(27*12)], nr=12),2, mean)) # to check for constant variance
(v <- apply (matrix(serie[1:(27*12)], nr=12),2, var))
plot(v~m)
abline(lm(v~m),col=2,lty=3)
group <- c(rep(1:27, rep(12, 27)))
boxplot(serie ~ group,
xlab = "Year",
ylab = "Monthly values",
main = "Check of constant variance (yearly boxplots)")
monthplot(serie)
d12serie=diff(serie,12)
plot(d12serie)
abline(h=0, col='red', lty=2)
d1d12serie=diff(d12serie,1)
#fix this output
var(serie)
var(d12serie)
var(d1d12serie) # our transformation
var(diff(d1d12serie)) # 2 regular differences
plot(d1d12serie)
abline(h=0, col='red', lty=2)
tserie <- d1d12serie #transformed serie is new name
par(mfrow=c(1,2))
acf(tserie, ylim=c(-1,1), lag.max=60, lwd=2)
pacf(tserie, ylim=c(-1,1), lag.max=60, lwd=2)
par(mfrow=c(1,2))
acf(tserie,ylim=c(-1,1),col=c(2,rep(1,11)),lwd=2,lag.max=72)
pacf(tserie,ylim=c(-1,1),col=c(rep(1,11),2),lwd=2,lag.max=72)
gc()
